<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>Hello World</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>

    <!-- Don't use this in production: -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>

  <style>
    body {
      margin: 0;
    }
  </style>

  <body>
    <div id="root"></div>
    <script type="text/babel">
      const container = document.getElementById("root");
      const root = ReactDOM.createRoot(container);

      function Todo({ title, id, completed, onChange }) {
        return (
          <div
            key={id}
            style={{
              display: "flex",
              justifyContent: "space-between",
              alignItems: "center",
              textDecoration: completed ? "line-through" : "none",
            }}
          >
            <li>{title}</li>
            <input type="checkbox" checked={completed} onChange={onChange} />
          </div>
        );
      }

      function NewTodo({ onNewTodo }) {
        const [newTodoTitle, setNewTodoTitle] = React.useState("");

        return (
          <form
            style={{
              display: "flex",
              justifyContent: "space-between",
              alignItems: "center",
            }}
            onSubmit={(event) => {
              event.preventDefault();
              onNewTodo(newTodoTitle);
              setNewTodoTitle("");
            }}
          >
            <input
              type="text"
              placeholder="Buscar tarea"
              value={newTodoTitle}
              onChange={(event) => setNewTodoTitle(event.target.value)}
            />
            <button disabled={newTodoTitle.length === 0}>crear</button>
          </form>
        );
      }

      function ToDos() {
        const [todos, setTodos] = React.useState([]);

        function createNewTodo(title) {
          if (!title) return;
          const newTodo = {
            id: Math.random().toString(),
            title,
            completed: false,
          };

          setTodos((currentTodos) => [newTodo, ...currentTodos]);
        }

        function handleCheck(event, todoId) {
          const checked = event.target.checked;
          setTodos((currentTodos) => {
            const newTodos = [...currentTodos];
            newTodos.find((t) => t.id === todoId).completed = checked;

            const sortedTodos = [
              ...newTodos.filter((t) => !t.completed),
              ...newTodos.filter((t) => t.completed),
            ];

            return sortedTodos;
          });
        }

        console.log("rendering");

        return (
          <div>
            <h1>Tareas por hacer</h1>
            <NewTodo onNewTodo={createNewTodo} />

            <ul>
              {todos.map((todo) => (
                <Todo
                  key={todo.id}
                  id={todo.id}
                  title={todo.title}
                  completed={todo.completed}
                  onChange={(event) => handleCheck(event, todo.id)}
                />
              ))}
            </ul>
          </div>
        );
      }

      function Card({ children }) {
        return (
          <div
            style={{
              border: "1px solid black",
              borderRadius: "4px",
              padding: "12px",
              backgroundColor: "#302244",
              border: "5px solid transparent",
              borderImage:
                "linear-gradient(to bottom right, #b827fc 0%, #2c90fc 25%, #b8fd33 50%, #fec837 75%, #fd1892 100%)",
              borderImageSlice: 1,
              margin: "20px auto",
              color: "white",
            }}
          >
            {children}
          </div>
        );
      }

      function App() {
        return (
          <div
            style={{
              display: "flex",
              justifyContent: "center",
              alignItems: "center",
              height: "100vh",
              backgroundColor: "lightblue",
            }}
          >
            <Card>
              <ToDos />
            </Card>
          </div>
        );
      }

      root.render(<App />);
    </script>
  </body>
</html>
